language: haxe

haxe:
  - 4.0.2

install:
  - haxelib git hscript https://github.com/HaxeFoundation/hscript.git
  - haxelib git hxbit https://github.com/HeapsIO/hxbit.git
  - haxelib git heaps https://github.com/HeapsIO/heaps.git
  - haxelib git castle https://github.com/ncannasse/castle.git
  - haxelib install format
  - haxelib install hldx
  - haxelib install hlopenal

script:
  - haxe hl.hxml
  - haxe js.hxml
  - haxe swf.hxml

notifications:
  slack: anagrammages:EtIhHhWsEUggGCYKulnafX3V

before_deploy:
  - zip -r cubeo.zip ./ --exclude=*LICENSE* --exclude=*.git* --exclude=*.vscode* --exclude=*src* --exclude=*.gitattributes* --exclude=*.gitignore* --exclude=*.yml* --exclude=*.hxml* --exclude=*.md* --exclude=*.bat*

deploy:
  provider: pages
  edge:
    branch: master
  token: ${GITHUB_TOKEN}
  file_glob: true
  file: "cubeo.zip"
  name: latest development build
  release_notes:
    Warning, this is a development build and not fully tested. Use at your own risk.
    I have no idea what I am doing.
  cleanup: false
  prerelease: true
  overwrite: true
  on:
    tags: false
    branch: master